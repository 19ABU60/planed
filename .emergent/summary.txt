<analysis>**original_problem_statement:**
The user, speaking German, requested an application to replace their Excel-based work plan for teachers. The initial request was: Can you create an app for me, with a user-friendly desktop, that includes the elements of my Excel file, but is much more functional and clearly arranged, and offers the possibility of extending the app with useful features later?

The user provided an Excel file () and further clarified the requirements:
- **Core Functionality:** Create, update, and manage work plans for a school year, for various classes and subjects (e.g., Class 6a - German).
- **Features:**
    - Integrate non-teaching days (holidays/absences).
    - A calendar view similar to the one in the Excel file.
    - Export function to Word.
    - Ability to manage multiple school years.
    - A folder/repository for documents (Word) and images (JPG) associated with individual lessons.
    - AI-powered suggestions for lesson topics (user preferred Gemini).
- **Design:** Dark and professional.

**User's preferred language**: German (Deutsch). The next agent MUST respond in German.

**what currently exists?**
A full-stack application (FastAPI backend, React frontend) has been developed, named PlanEd. The entire backend logic resides in a single  file, and the entire frontend is in a single  file.

The application supports:
- User authentication (Register/Login with JWT).
- CRUD operations for School Years, Classes/Subjects, and Lessons.
- A full-screen calendar for viewing and managing lessons.
- A statistics dashboard.
- A document management page.
- A feature to share work plans with other users (colleagues).
- A notification system for updates on shared plans.
- Drag-and-drop functionality to move lessons within the calendar.
- Partial German localization of the UI.

However, the last action taken was a complete overwrite of both  and  in an attempt to add a very large number of new features at once. The current state is unstable and untested.

**Last working item**:
- **Last item agent was working:** The user requested the implementation of a comprehensive list of new features. The agent began this by installing new dependencies (, , ) and then performing a complete overwrite of  and  with new, much larger versions intended to contain all the new functionality.
- **Status:** IN PROGRESS
- **Agent Testing Done:** N
- **Which testing method agent to use?** both. The backend and frontend have been completely rewritten and must be thoroughly tested. Start with  to get a baseline of the (likely broken) state.
- **User Testing Done:** N

**All Pending/In progress Issue list**:
- **Issue 1 (P0):** The application is likely broken due to a big bang rewrite of the core  and  files. The agent overwrote them completely instead of making incremental changes. This monolithic file structure is unsustainable and the code is untested.
  - **Attempted fixes:** None. This was the last action.
  - **Next debug checklist:**
    1.  Immediately run  to assess the full extent of the breakage.
    2.  Review the  logs for both frontend and backend to check for startup errors (e.g., missing imports, syntax errors). ==> /var/log/supervisor/backend.err.log <==
INFO:     Application shutdown complete.
INFO:     Finished server process [604]
INFO:     Started server process [1347]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'server.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1347]
INFO:     Started server process [1996]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'server.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [1996]
INFO:     Started server process [2073]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [2073]
INFO:     Stopping reloader process [602]
INFO:     Will watch for changes in these directories: ['/app/backend']
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [2669] using WatchFiles
INFO:     Started server process [2671]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'server.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [2671]
INFO:     Started server process [3098]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'server.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3098]
INFO:     Started server process [3148]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'server.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3148]
INFO:     Started server process [3216]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'server.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3216]
INFO:     Started server process [3276]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3276]
INFO:     Stopping reloader process [2669]
INFO:     Will watch for changes in these directories: ['/app/backend']
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [3563] using WatchFiles
INFO:     Started server process [3565]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'server.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3565]
INFO:     Started server process [6081]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [6081]
INFO:     Stopping reloader process [3563]
INFO:     Will watch for changes in these directories: ['/app/backend']
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [6172] using WatchFiles
INFO:     Started server process [6174]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Will watch for changes in these directories: ['/app/backend']
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
INFO:     Started reloader process [48] using WatchFiles
INFO:     Started server process [84]
INFO:     Waiting for application startup.
INFO:     Application startup complete.

==> /var/log/supervisor/backend.out.log <==
INFO:     10.64.136.142:48972 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.136.142:48974 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.5:38558 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.16:55708 - "GET /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.136.142:48980 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.136.138:48228 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.5:38572 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.16:55724 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.5:38558 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.4:60028 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.136.142:48974 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.4:60036 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.16:55708 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.5:38558 - "OPTIONS /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.16:55708 - "POST /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.5:49958 - "OPTIONS /api/notifications/unread-count HTTP/1.1" 200 OK
INFO:     10.64.128.16:55872 - "GET /api/notifications/unread-count HTTP/1.1" 200 OK
INFO:     10.64.128.16:42462 - "OPTIONS /api/auth/login HTTP/1.1" 200 OK
INFO:     10.64.136.138:59020 - "POST /api/auth/login HTTP/1.1" 200 OK
INFO:     10.64.128.4:59028 - "OPTIONS /api/auth/me HTTP/1.1" 200 OK
INFO:     10.64.136.138:59020 - "GET /api/auth/me HTTP/1.1" 200 OK
INFO:     10.64.136.138:59020 - "OPTIONS /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.4:59028 - "OPTIONS /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.128.16:42462 - "OPTIONS /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.136.138:59020 - "OPTIONS /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.16:42476 - "OPTIONS /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.136.142:45738 - "OPTIONS /api/classes HTTP/1.1" 200 OK
INFO:     10.64.136.142:45750 - "OPTIONS /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.128.5:35652 - "OPTIONS /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.5:35658 - "OPTIONS /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.5:35674 - "OPTIONS /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.4:59028 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.16:42476 - "GET /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.128.5:35658 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.16:42462 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.136.142:45750 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.136.138:59024 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.136.138:59024 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.4:59028 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.16:42462 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.5:35658 - "GET /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.128.4:59028 - "OPTIONS /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.136.142:45750 - "POST /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.4:59028 - "OPTIONS /api/classes HTTP/1.1" 200 OK
INFO:     10.64.136.142:45750 - "POST /api/classes HTTP/1.1" 200 OK
INFO:     10.64.136.142:51670 - "OPTIONS /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.4:56606 - "POST /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.136.142:37020 - "OPTIONS /api/auth/login HTTP/1.1" 200 OK
INFO:     10.64.128.16:43736 - "POST /api/auth/login HTTP/1.1" 200 OK
INFO:     10.64.128.16:43736 - "OPTIONS /api/auth/me HTTP/1.1" 200 OK
INFO:     10.64.128.5:55080 - "GET /api/auth/me HTTP/1.1" 200 OK
INFO:     10.64.136.138:54014 - "OPTIONS /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.136.142:37020 - "OPTIONS /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.16:43736 - "OPTIONS /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.136.138:54026 - "OPTIONS /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.4:35198 - "OPTIONS /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.136.142:37020 - "OPTIONS /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.136.138:54026 - "OPTIONS /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.136.138:54014 - "OPTIONS /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.16:43736 - "OPTIONS /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.136.142:37028 - "OPTIONS /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.136.138:54042 - "GET /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.128.4:35198 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.16:43736 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.5:55080 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.136.142:37020 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.5:55080 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.136.142:37020 - "GET /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.136.142:37028 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.4:35198 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.4:35214 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.5:55080 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.136.142:37028 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.4:35214 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.5:55080 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.136.142:50900 - "OPTIONS /api/auth/login HTTP/1.1" 200 OK
INFO:     10.64.128.4:47518 - "POST /api/auth/login HTTP/1.1" 200 OK
INFO:     10.64.136.142:50900 - "OPTIONS /api/auth/me HTTP/1.1" 200 OK
INFO:     10.64.128.16:41036 - "GET /api/auth/me HTTP/1.1" 200 OK
INFO:     10.64.136.142:50900 - "OPTIONS /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.16:41036 - "OPTIONS /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.4:47518 - "OPTIONS /api/classes HTTP/1.1" 200 OK
INFO:     10.64.136.142:50900 - "OPTIONS /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.136.138:38406 - "OPTIONS /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.136.138:38412 - "OPTIONS /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.136.138:38396 - "OPTIONS /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.5:59070 - "OPTIONS /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.128.5:59074 - "OPTIONS /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.128.5:59090 - "OPTIONS /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.16:41036 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.128.4:47518 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.5:59074 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.16:41050 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.128.4:47534 - "GET /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.128.16:41050 - "GET /api/school-years HTTP/1.1" 200 OK
INFO:     10.64.136.138:38412 - "GET /api/notifications HTTP/1.1" 200 OK
INFO:     10.64.136.138:38406 - "GET /api/holidays HTTP/1.1" 200 OK
INFO:     10.64.136.138:38406 - "GET /api/lessons HTTP/1.1" 200 OK
INFO:     10.64.128.16:41050 - "GET /api/classes HTTP/1.1" 200 OK
INFO:     10.64.128.4:41986 - "GET /api/ HTTP/1.1" 200 OK and ==> /var/log/supervisor/frontend.err.log <==
(node:79) [DEP_WEBPACK_DEV_SERVER_ON_AFTER_SETUP_MIDDLEWARE] DeprecationWarning: 'onAfterSetupMiddleware' option is deprecated. Please use the 'setupMiddlewares' option.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:79) [DEP_WEBPACK_DEV_SERVER_ON_BEFORE_SETUP_MIDDLEWARE] DeprecationWarning: 'onBeforeSetupMiddleware' option is deprecated. Please use the 'setupMiddlewares' option.
(node:85) [DEP_WEBPACK_DEV_SERVER_ON_AFTER_SETUP_MIDDLEWARE] DeprecationWarning: 'onAfterSetupMiddleware' option is deprecated. Please use the 'setupMiddlewares' option.
(Use `node --trace-deprecation ...` to show where the warning was created)
(node:85) [DEP_WEBPACK_DEV_SERVER_ON_BEFORE_SETUP_MIDDLEWARE] DeprecationWarning: 'onBeforeSetupMiddleware' option is deprecated. Please use the 'setupMiddlewares' option.

==> /var/log/supervisor/frontend.out.log <==
WARNING in [eslint] 
src/App.js
  Line 1271:6:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps
  Line 1723:6:  React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps

webpack compiled with 1 warning
Compiling...
Compiled with warnings.

[eslint] 
src/App.js
  Line 1290:6:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps
  Line 1742:6:  React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps

Search for the keywords to learn more about each warning.
To ignore, add // eslint-disable-next-line to the line before.

WARNING in [eslint] 
src/App.js
  Line 1290:6:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps
  Line 1742:6:  React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps

webpack compiled with 1 warning
Compiling...
Compiled with warnings.

[eslint] 
src/App.js
  Line 1325:6:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps
  Line 1777:6:  React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps

Search for the keywords to learn more about each warning.
To ignore, add // eslint-disable-next-line to the line before.

WARNING in [eslint] 
src/App.js
  Line 1325:6:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps
  Line 1777:6:  React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps

webpack compiled with 1 warning
Compiling...
Compiled with warnings.

[eslint] 
src/App.js
  Line 1325:6:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps
  Line 1777:6:  React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps

Search for the keywords to learn more about each warning.
To ignore, add // eslint-disable-next-line to the line before.

WARNING in [eslint] 
src/App.js
  Line 1325:6:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps
  Line 1777:6:  React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps

webpack compiled with 1 warning
Compiling...
Compiled with warnings.

[eslint] 
src/App.js
  Line 1325:6:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps
  Line 1777:6:  React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps

Search for the keywords to learn more about each warning.
To ignore, add // eslint-disable-next-line to the line before.

WARNING in [eslint] 
src/App.js
  Line 1325:6:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps
  Line 1777:6:  React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps

webpack compiled with 1 warning
Compiling...
Failed to compile.

Attempted import error: 'unmountComponentAtNode' is not exported from 'react-dom' (imported as 'ReactDOM').
WARNING in [eslint] 
src/App.js
  Line 254:6:    React Hook useEffect has missing dependencies: 'fetchNotifications' and 'fetchUnreadCount'. Either include them or remove the dependency array  react-hooks/exhaustive-deps
  Line 903:42:   React Hook useEffect has a missing dependency: 'fetchTemplates'. Either include it or remove the dependency array                               react-hooks/exhaustive-deps
  Line 1007:38:  React Hook useEffect has a missing dependency: 'fetchTodos'. Either include it or remove the dependency array                                   react-hooks/exhaustive-deps
  Line 1347:39:  React Hook useEffect has a missing dependency: 'fetchShares'. Either include it or remove the dependency array                                  react-hooks/exhaustive-deps

ERROR in ./node_modules/react-joyride/dist/index.mjs 1352:6-37
export 'unmountComponentAtNode' (imported as 'ReactDOM') was not found in 'react-dom' (possible exports: __DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, createPortal, flushSync, preconnect, prefetchDNS, preinit, preinitModule, preload, preloadModule, requestFormReset, unstable_batchedUpdates, useFormState, useFormStatus, version)

ERROR in ./node_modules/react-joyride/dist/index.mjs 1367:6-50
export 'unstable_renderSubtreeIntoContainer' (imported as 'ReactDOM') was not found in 'react-dom' (possible exports: __DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE, createPortal, flushSync, preconnect, prefetchDNS, preinit, preinitModule, preload, preloadModule, requestFormReset, unstable_batchedUpdates, useFormState, useFormStatus, version)

webpack compiled with 2 errors and 1 warning
yarn run v1.22.22
$ craco start
Attempting to bind to HOST environment variable: 0.0.0.0
If this was unintentional, check that you haven't mistakenly set it in your shell.
Learn more here: https://cra.link/advanced-config

Starting the development server....
    3.  **Crucially, refactor the massive  file.** Break it down into logical components and pages (e.g., , , , ) as per standard React best practices. The agent's original plan included this, but it was not followed.
    4.  Similarly, review  and consider splitting it into multiple files (e.g., routers, models, services) if it has become unmanageable.
  - **Why fix this issue and what will be achieved with the fix?** To restore the application to a stable, working state and establish a sustainable architecture for adding the new features the user requested.
  - **Status:** NOT STARTED
  - **Is recurring issue?** N
  - **Should Test frontend/backend/both after fix?** both
  - **Blocked on other issue:** None. This is the primary blocker.

**In progress Task List**:
- **Task 1 (P0):** Implement all features from the user-approved list. This was the task the agent was working on when it broke the application.
  - **Where to resume:** Resume after stabilizing and refactoring the codebase (see Issue 1). Once the app is working again, begin implementing the features from the list below, one by one, with testing after each feature.
  - **What will be achieved with this?** The application will be enhanced with a rich set of features as requested by the user.
  - **Status:** BLOCKED
  - **Should Test frontend/backend/both after fix?** both
  - **Blocked on something:** Blocked on Issue 1.

**Upcoming and Future Tasks**
The user requested all of the following features to be implemented. They should be implemented incrementally after the application is stabilized.

**Phase 1 (High Priority):**
- **(P0) Deutsche Schulferien:** Automatically integrate German school holidays by state (e.g., Bavaria, NRW) into the calendar. The  library was already installed.
- **(P0) Vorlagen-Bibliothek:** Create a template library to save and reuse lesson plans.
- **(P1) Excel-Import:** Allow users to import existing work plans from Excel files.
- **(P1) Kommentare:** Add a commenting feature to shared work plans.

**Phase 2 (Medium Priority):**
- **(P1) Erweiterte Statistik-Diagramme:** Enhance the statistics page with more chart types (bar, pie, line) for visualizing lesson distribution. The  library was installed.
- **(P1) Mobile App / PWA:** Make the application mobile-friendly and available as a Progressive Web App (PWA) for offline use.
- **(P2) E-Mail-Benachrichtigungen:** Send email notifications for important events (e.g., plan shared, comments added). This will require a new integration (e.g., SendGrid, Resend).
- **(P2) Materialien verknüpfen:** Allow associating uploaded documents directly with specific lesson entries in the calendar.

**Phase 3 (Lower Priority):**
- **(P2) Lehrplan-Datenbank:** Integrate a database of pre-made curriculum content, filterable by subject and state.
- **(P2) Fachschafts-Räume:** Create shared spaces/workspaces for subject departments.
- **(P3) KI-Arbeitsblätter:** Use an AI model to automatically generate worksheets based on lesson topics.
- ...and all other items from the agent's generated list.

**Completed work in this session**
- **MVP Application:**
  - Implemented user authentication (registration, login) in  and .
  - Created backend endpoints and frontend UI for managing school years, classes, and lessons.
  - Built the main calendar view, a statistics page, and a document upload page.
- **Sharing Feature:**
  - Added backend endpoints (, ) and frontend UI to allow users to share classes with colleagues with view-only or edit permissions.
- **UI Localization:**
  - Translated a significant portion of the frontend UI text from English to German in .
- **Notification System:**
  - Implemented a backend and frontend system to notify users about actions on shared plans, with a notification bell in the UI header.
- **Calendar Drag & Drop:**
  - Integrated  to allow users to move lessons to different days on the calendar via drag and drop.

**Code Architecture**


**Key Technical Concepts**
- **Backend:** FastAPI, MongoDB (via ), Pydantic, JWT for authentication.
- **Frontend:** React, , , , .
- **Architecture:** Single-Page Application (SPA) with a monolithic frontend () and a monolithic backend ().

**key DB schema**
- : {id, email, password, name}
- : {id, user_id, name, start_date, end_date}
- : {id, user_id, name, subject, color_hex, school_year_id}
- : {id, class_subject_id, date, topic, objective, key_terms, notes}
- : {id, user_id, filename, content_type, size, upload_date}
- : {id, owner_id, shared_with_user_id, class_subject_id, permission}
- : {id, user_id, message, read, created_at}

**All files of reference**
- : The single file for all backend logic. It was just overwritten and is untested.
- : The single file for all frontend components and logic. It was just overwritten, is extremely large, and needs to be refactored.
- : Contains all the styling for the application.
- : Contains the project requirements and a log of completed work.

**Areas that need refactoring**:
- ** is CRITICAL.** It is a single file containing all pages, components, logic, and state management for the entire application. This is an anti-pattern that makes the app extremely difficult to maintain or debug. It must be broken down into a proper React component structure (e.g., , ). This should be the very first task for the next agent after verifying the app is broken.

**key api endpoints**
- 
-  (full CRUD)
- 
- 
- 
- 

**Critical Info for New Agent**
- **The application is very likely in a broken state.** The previous agent attempted a massive implement everything task by completely overwriting the core backend and frontend files. Do not trust that this new code works.
- **Your first priority is to stabilize and refactor.** Before adding any new features, you must:
    1.  Get the application running again.
    2.  **Refactor ** into a proper component-based architecture. This is not optional; the current monolithic file is unmanageable.
- Once the application is stable, proceed with the user's requested features **incrementally**. Implement one feature at a time and test it before moving to the next.
- The user's language is **German**. All communication must be in German.

**documents and test reports created in this job**
- 
- 
- 
- 

**Last 10 User Messages and any pending HUMAN messages**
1.  **User:** ja (yes) - Agreed to implementing Drag & Drop.
2.  **Agent:** Completed Drag & Drop, suggested integrating German school holidays.
3.  **User:** Kannst du mir eine Übersicht über alle Verbesserungsvorschläge, die die App noch nutzerfreundlicher und funktionaler macht, erstellen! (Can you create an overview of all improvement suggestions that would make the app even more user-friendly and functional!)
4.  **Agent:** Provided a detailed, categorized, and prioritized list of potential new features.
5.  **User:** implementier alles (implement everything) - **This is the current high-level task.**
6.  **Agent:** Acknowledged the large scope and began implementation.

**Project Health Check:**
- **Broken:** The core application files (, ) were completely overwritten in a single step without testing. It is highly probable that the application will not start or will have significant errors.

**3rd Party Integrations**
- **Gemini:** For AI-powered lesson topic suggestions. Uses the  library and requires the Emergent LLM Key.
- **holidays:** A Python library added to fetch German holidays.

**Testing status**
- **Testing agent used after significant changes:** YES (but not after the *last* major change).
- **Troubleshoot agent used after agent stuck in loop:** NO
- **Test files created:** None, testing was done via .
- **Known regressions:** The entire application is a potential regression.

**What agent forgot to execute**
The agent failed to follow its own initial plan to structure the frontend with separate files for pages and components. Instead, it created a monolithic  file, which is a major architectural flaw that has made the project difficult to manage and is the root cause of the current instability.</analysis>
